# Проект "Кошачий благотворительный фонд QRKot"

## Описание проекта

Данный сервис создан для поддержки хвостатых. Пользователи могут внести пожертвование,
сопроводив его комментарием или пожеланием. Администраторы сервиса создают проекты в помощь
приютам для животных и другим заинтересованным. Проекты не целевые: распределение средств
происходит автоматически в порядке создания проектов.

## Технологии и библиотеки

 - Python 3.7
 - FastAPI (веб-фреймворк для создания API)
 - SQLAlchemy (библиотека для работы с реляционными СУБД с применением технологии ORM)
 - Pydantic (библиотека для валидации и сериализации данных)
 - Alembic (инструмент для миграции базы данных)
 - Uvicorn (высокопроизводительный ASGI сервер)

## Как запустить проект

Клонировать репозиторий и перейти в него в командной строке:
```
git clone https://github.com/fluid1408/cat_charity_fund
```

Создать и активировать виртуальное окружение:
```
python3 -m venv env
```

* Если у вас Linux/macOS

    ```
    source venv/bin/activate
    ```

* Если у вас windows

    ```
    source venv/scripts/activate
    ```

Установить зависимости из файла requirements.txt:

```
python3 -m pip install --upgrade pip
```

```
pip install -r requirements.txt
```

В директории проекта создайте файл .env и заполните его по образцу:

```
APP_TITLE=Кошачий благотворительный фонд
APP_DESCRIPTION=Сервис для поддержки котиков!
DATABASE_URL=sqlite+aiosqlite:///./fastapi.db
SECRET=<mysecret>
FIRST_SUPERUSER_EMAIL=<user@example.com>
FIRST_SUPERUSER_PASSWORD=password_example

```

Применить миграции:

```
alembic upgrade head
```

Запустите проект

```
uvicorn app.main:app --reload
```

Для того чтобы открыть документацию проекта, перейдите по ссылке http://127.0.0.1:8000/docs/ после запуска проекта.

## API
Данный сервис является API, так что может быть интегрирован в вашу систему.

### Ресурсы приложения
QRKot имеет три ресурса: "Проекты", "Пожертвования" и "Пользователи".
Работа с пользователями осуществляется с помощью стандартного модуля FastAPI Users.

Список проектов может быть просмотрен любым пользователем сервиса. Создание, редактирование
и удаление проектов доступно только суперпользователям.

Пожертвование может сделать любой пользователь. Также он может посмотреть список
своих пожертвований. Суперпользователь может посмотреть список всех пожертвований.

Для регистрации выполните POST запрос на http://127.0.0.1:8000/auth/register:
```
curl -X 'POST' \
  'http://127.0.0.1:8000/auth/register' \
  -H 'accept: application/json' \
  -H 'Content-Type: application/json' \
  -d '{
  "email": "user@example.com",
  "password": "your_password"
  }'
```

Для аутентификации и получения токена выполните POST запрос на http://127.0.0.1:8000/auth/jwt/login
```
curl -X 'POST' \
  'http://127.0.0.1:8000/auth/jwt/login' \
  -H 'accept: application/json' \
  -H 'Content-Type: application/x-www-form-urlencoded' \
  -d 'grant_type=&username=username&password=password&scope=&client_id=&client_secret='
```

Пример ответа в случае успешного выполнения:
```
{
  "access_token": "token",
  "token_type": "bearer"
}
```

Далее используйте этот токен при остальных запросах к сервису - передавайте его в заголовках запросов.

**Пример**

Для создания нового пожертвования выполните POST запрос на http://127.0.0.1:8000/donation/:
```
curl -X 'POST' \
  'http://127.0.0.1:8000/donation/' \
  -H 'accept: application/json' \
  -H 'Content-Type: application/json' \
  -d '{
  "comment": "Пожертвования котикам",
  "full_amount": 500
  }'
```

Пример ответа в случае успешного выполнения

```
{
  "comment": "Пожертвования котикам",
  "full_amount": 500,
  "id": 1,
  "create_date": "2023-07-22T03:21:26.369602"
}
```

## Автор проекта

Шлемин С.А.
